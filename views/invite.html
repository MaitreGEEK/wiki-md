<!DOCTYPE html>
<html lang="fr">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="robots" content="noindex">
	<title>Invitation - Wiki-MD</title>
	<link rel="stylesheet" href="/public/styles.css">
</head>
<body>
	<div class="login-container">
		<div class="login-box">
			<h1 style="text-align: center; margin-bottom: 2rem;">ðŸ“š Wiki-MD</h1>
			<p style="text-align: center; margin-bottom: 2rem;">Vous Ãªtes invitÃ© en tant que <strong>{{role}}</strong></p>
			
			<form onsubmit="acceptInvite(event)" class="card">
				<div class="form-group">
					<label for="username">Nom d'utilisateur</label>
					<input type="text" id="username" required>
				</div>
				
				<div class="form-group">
					<label for="display_name">Nom affichÃ©</label>
					<input type="text" id="display_name">
				</div>
				
				<div class="form-group">
					<label for="password">Mot de passe</label>
					<input type="password" id="password" required>
				</div>
				
				<button type="submit">CrÃ©er mon compte</button>
			</form>
		</div>
	</div>

	<script>
		async function acceptInvite(event) {
			event.preventDefault();
			
			const data = {
				username: document.getElementById('username').value,
				display_name: document.getElementById('display_name').value,
				password: document.getElementById('password').value
			};
			
			const response = await fetch('/api/invitation/{{token}}', {
				method: 'POST',
				headers: { 'Content-Type': 'application/json' },
				body: JSON.stringify(data)
			});
			
			if (response.ok) {
				alert('Compte crÃ©Ã© ! Vous pouvez maintenant vous connecter.');
				location.href = '/login';
			} else {
				const result = await response.json();
				alert(result.error || 'Erreur lors de la crÃ©ation du compte');
			}
		}
	</script>
</body>
</html>
